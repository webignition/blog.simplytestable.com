---
layout: default
title: "The Switch to Guzzle is Complete"
date: 2013-04-24 14:30
author:
    name: Jon Cram
    url: https://github.com/webignition

---

<div class="section">
    <p>
        I've spent the past 4 weeks (or so) switching from our <a href="https://github.com/webignition/http-client">own HTTP client
        library</a> to a third-party HTTP client library called <a href="http://guzzlephp.org/">Guzzle</a>.
    </p>

    <p>
        This change was brought about by the fact that our own HTTP client is
        dependent on a PHP extension that (at least currently) doesn't work with
        PHP 5.5 and which is not under any particular active development.
    </p>

    <p>
        Guzzle, on the other hand, is not dependent on any PHP extensions and is
        continually being improved and updated.
    </p>

    <p>
        As the provider of a service that is heavily based around retrieving
        resources from the web for later testing, the HTTP client we use to do this
        is at the centre of everything that goes on.
    </p>

    <p>
        Switching HTTP client libraries turned out to be a non-trivial task.
    </p>

    <p>
        Guzzle handles error cases differently, presents a slightly different means
        for mocking HTTP responses in code
        tests and provides a slightly different means for retrying failed requests.
        None of this is bad, it's just different and takes time to apply correctly.
    </p>

    <p>
        Did I mention that the HTTP client is at the centre of everything? Changing
        the HTTP client changes everything.
    </p>

    <p>
        Well, maybe not everything, but lots:
    </p>

    <ul>
        <li>
    <p>
        All code tests that make use of mock (or pretend) HTTP responses had to be
        updated to use the slightly different means Guzzle uses for achieving this.
    </p>
        </li>
        <li>
    <p>
        Everything had to be re-tested.
    </p>
        </li>
        <li>
    <p>
        Areas of code that were changed that did not have code tests had to have
        tests created.
    </p>
        </li>
        <li>
    <p>
        Minor issues spotted when creating and then running code tests had to be
        fixed.
    </p>
        </li>
    </ul>

    <p>
        At the end of this change, we now have a much more stable and future-proof
        system:
    </p>

    <ul>
        <li>
    <p>
        The code is more readily testable and has seen a large increase in the
        number of code tests in use, reducing the chance of inadvertently-introduced
        bugs getting released into the wild.
    </p>
        </li>
        <li>
    <p>
Everything works under PHP 5.3, 5.4 and 5.5.
    </p>
        </li>
        <li>
    <p>
Improved HTTP caching abilities present the option for further performance improvements.
    </p>
        </li>
    </ul>

    <p>
        For you, someone who uses Simply Testable to run full-site HTML validation,
        CSS validation and JavaScript static analysis, the completion of this change
        means two important things: everything will work much better, and I can
        now start introducing new features and improvements to make Simply Testable
        more useful.
    </p>

</div>